<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Online Chat</title>

    <link rel="stylesheet" href="./normalize.css">
    <link rel="stylesheet" href="./index.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" defer></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-app.js" defer></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-database.js" defer></script>
    <script src="./index.js" defer></script>
  </head>

  <body>
    <div id="header">
      <button id="info-button" onclick="openInfoWindow()">What is this?</button>
      <h1 id="title">Chat Hub</h1>  
      <p1 id="new-message" style="display: none;">New message sent!</p1> 
      <p2 id="user-number">Users Online: <span id="users-online"></span></p2> 
      <button id="github-button" onclick="window.location.href='https://github.com/notasquid1938/BlazeChatHub';">
        View Github
      </button>
    </div>
    
    <div id="info-window">
      <p>This is a real-time chat website called Chat Hub. It is hosted on firebase and allows for large scale, partially anonymous communication. All messages are encrypted using AES-256 before being sent to the database so only those viewing the website can see what is written. You can click the github button to view this site's source code if you would like to verify this all for yourself. Be kind, have fun!</p>
      <button onclick="closeInfoWindow()">Close</button>
    </div>
    
    <script>
      function openInfoWindow() {
        var infoWindow = document.getElementById("info-window");
        infoWindow.style.display = "block";
      }
      
      function closeInfoWindow() {
        var infoWindow = document.getElementById("info-window");
        infoWindow.style.display = "none";
      }
    </script>             

    <div id="messages"></div>

    <div id="chatbox">
      <div id="chat-input-container">
        <div id="chat-input" placeholder="Type here..." maxlength="1000" contenteditable="true"></div>
        <span id="chat-input-counter">1000</span>
      </div>
    
      <div id="chat-formatting-options">
        <div>
          <label for="font-select">Font:</label>
          <select id="font-select" class="chat-formatting-button" onchange="document.execCommand('fontName', false, this.value)">
            <option value="Arial">Arial</option>
            <option value="Helvetica">Helvetica</option>
            <option value="Times New Roman">Times</option>
            <option value="Georgia">Georgia</option>
            <option value="Courier">Courier</option>
            <option value="Verdana">Verdana</option>
            <option value="Tahoma">Tahoma</option>
            <option value="Comic Sans MS">Comic Sans</option>
          </select>
        </div>
        <div>
          <button class="chat-formatting-button" onclick="toggleFormatting('bold')"><b>B</b></button>
          <button class="chat-formatting-button" onclick="toggleFormatting('underline')"><u>U</u></button>
          <input type="color" class="chat-formatting-button" onchange="document.execCommand('foreColor', false, this.value)">
        </div>
      </div>
    
      <input type="button" id="chat-submit" value="Send">
    </div>

    <style>
      .chat-formatting-button.selected {
        background-color: rgb(50, 170, 255);
      }
    </style>
    
    <script>
      function toggleFormatting(format) {
        document.execCommand(format, false, null);
        var button = document.querySelector(`button[onclick="toggleFormatting('${format}')"`);
        button.classList.toggle("selected");
      }
    </script>    
  </body>
</html>
